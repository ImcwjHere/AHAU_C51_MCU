C51 COMPILER V9.01   SETTINGSCREEN                                                         12/06/2023 12:06:33 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE SETTINGSCREEN
OBJECT MODULE PLACED IN .\settingScreen.obj
COMPILER INVOKED BY: D:\Program Files\Keil\C51\BIN\C51.EXE ..\eide\src\screens\settingScreen.c BROWSE DEBUG OBJECTEXTEND
                    - PRINT(.\settingScreen.lst) OBJECT(.\settingScreen.obj)

line level    source

   1          #include "settingScreen.h"
   2          
   3          void settingScreen() {
   4   1          bit currentCursor=0, prevCursor=0;    // 当前/上一个光标位置，0表示控制最高温度，1表示控制最低温度
   5   1          bit splashState=0;  // 闪烁光标状态，0表示显示温度，1表示显示空格
   6   1          unsigned char blankspaceText[] = "   ";    // 空格
   7   1      
   8   1              
   9   1              
  10   1              while (!SETTING_BUTTON);    // 等待按键释放
  11   1          alartScreen("Setting...");
  12   1      
  13   1          
  14   1          // 如果按下APPLY_BUTTON则退出设置界面
  15   1          while (APPLY_BUTTON) {
  16   2              
  17   2              // 如果光标位置发生变化，则重新显示屏幕画面（防止之前的光标还处于空格状态）
  18   2              if (currentCursor != prevCursor) {
  19   3                  putStringOnLCD1602(0, 0, firstLine);
  20   3                  prevCursor = currentCursor;
  21   3              }
  22   2      
  23   2              // 再次按下SETTING_BUTTON切换光标位置
  24   2              if (!SETTING_BUTTON) {
  25   3                  while (!SETTING_BUTTON);    // 等待按键释放
  26   3                  currentCursor = !currentCursor;
  27   3              }
  28   2      
  29   2              // 根据光标位置判断控制哪个温度
  30   2              if (!currentCursor) {   // 控制最高温度
  31   3                  // 闪烁光标: 在空格和温度之间切换, splashState为bit变量，在0和1之间反复横跳
  32   3                              splashState = !splashState;
  33   3                  splashState?putStringOnLCD1602(0, 2, blankspaceText):putStringOnLCD1602(0, 0, firstLine);
  34   3                  if (!ADD_BUTTON) {  // 如果按下ADD_BUTTON则增加最高温度（不超过128摄氏度）
  35   4                      while (!ADD_BUTTON);    // 等待按键释放
  36   4                      highestTemperature ++;
  37   4                      if (highestTemperature > 128) highestTemperature = 128;
  38   4                      // 将int记录的最高温度转换为字符串, 修改对应屏幕显示内容
  39   4                      floatToText(highestTemperature, onScreenHighestTemperature);
  40   4                  }
  41   3                  if (!SUB_BUTTON) {  // 如果按下SUB_BUTTON则减少最高温度（不低于最低温度）
  42   4                      while (!SUB_BUTTON);    // 等待按键释放
  43   4                      highestTemperature --;
  44   4                      if (highestTemperature < lowestTemperature) highestTemperature = lowestTemperature;
  45   4                      // 将int记录的最高温度转换为字符串, 修改对应屏幕显示内容
  46   4                      floatToText(highestTemperature, onScreenHighestTemperature);
  47   4                  }
  48   3              } else {    // 控制最低温度
  49   3                  // 闪烁光标: 在空格和温度之间切换, splashState为bit变量，在0和1之间反复横跳
  50   3                  splashState = !splashState;
  51   3                              splashState?putStringOnLCD1602(0, 11, blankspaceText):putStringOnLCD1602(0, 0, firstLine);
  52   3                  if (!ADD_BUTTON) {  // 如果按下ADD_BUTTON则增加最低温度（不高于最高温度）
  53   4                      while (!ADD_BUTTON);    // 等待按键释放
  54   4                      lowestTemperature ++;
C51 COMPILER V9.01   SETTINGSCREEN                                                         12/06/2023 12:06:33 PAGE 2   

  55   4                      if (lowestTemperature > highestTemperature) lowestTemperature = highestTemperature;
  56   4                      // 将int记录的最高温度转换为字符串, 修改对应屏幕显示内容
  57   4                      floatToText(lowestTemperature, onScreenLowestTemperature);
  58   4                  }
  59   3                  if (!SUB_BUTTON) {  // 如果按下SUB_BUTTON则减少最低温度（不低于-55摄氏度）
  60   4                      while (!SUB_BUTTON);    // 等待按键释放
  61   4                      lowestTemperature --;
  62   4                      if (lowestTemperature < -55) lowestTemperature = -55;
  63   4                      // 将int记录的最高温度转换为字符串, 修改对应屏幕显示内容
  64   4                      floatToText(lowestTemperature, onScreenLowestTemperature);
  65   4                  }
  66   3              }
  67   2              delayOneMillisecond(300);
  68   2          }
  69   1      
  70   1          // 保存设置
  71   1          alartScreen("Writing...");
  72   1          writeAT24C02(0x00, (unsigned char)(highestTemperature));
  73   1          writeAT24C02(0x01, (unsigned char)(lowestTemperature));
  74   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    381    ----
   CONSTANT SIZE    =     26    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----       3
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
